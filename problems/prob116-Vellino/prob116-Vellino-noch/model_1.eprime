language ESSENCE' 1.0

given maxMaterial: int
given fin1: int
given fin2: int
given quantity_Function1D: matrix indexed by [int(1..5)] of int(0..fin2)
given fin3: int
given fin4: int
given capacity_Function1D: matrix indexed by [int(1..3)] of int(0..fin4)
letting let1 be sum([quantity_Function1D[m] | m : int(1..5)])
find colour_Function1DPartial_Flags: matrix indexed by [int(1..let1)] of bool
find colour_Function1DPartial_Values:
        matrix indexed by [int(1..let1)] of int(1..3)
find contents_Function1DPartialR7_Flags:
        matrix indexed by [int(1..let1)] of bool
find contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags:
        matrix indexed by [int(1..let1), int(1..maxMaterial * 5)] of int(0..maxMaterial)
find contents_Function1DPartialR7_Values_ExplicitWithFlags_Values:
        matrix indexed by [int(1..let1), int(1..maxMaterial * 5)] of int(1..5)
minimising
    sum([toInt(colour_Function1DPartial_Flags[q69]) | q69 : int(1..let1)])
such that
    and([colour_Function1DPartial_Flags[b] <-> contents_Function1DPartialR7_Flags[b]
             | b : int(1..let1)]),
    and([sum([toInt(contents_Function1DPartialR7_Flags[q16]) *
              sum([toInt(contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q16, q14]
                         > 0
                         /\ contents_Function1DPartialR7_Flags[q16])
                   *
                   toInt(contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q16, q14] =
                         m)
                       | q14 : int(1..maxMaterial * 5)])
                  | q16 : int(1..let1)])
         = quantity_Function1D[m]
             | m : int(1..5)]),
    and([colour_Function1DPartial_Flags[q22] ->
         sum([toInt(contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q22, q20]
                    > 0
                    /\ contents_Function1DPartialR7_Flags[q22])
                  | q20 : int(1..maxMaterial * 5)])
         <= capacity_Function1D[colour_Function1DPartial_Values[q22]]
         /\ colour_Function1DPartial_Flags[q22]
             | q22 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q28] ->
         (colour_Function1DPartial_Values[q28] = 1 /\ colour_Function1DPartial_Flags[q28]
          ->
          !or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q28, q24] > 0
               /\ contents_Function1DPartialR7_Flags[q28]
               /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q28, q24] = 2
                   | q24 : int(1..maxMaterial * 5)])
          /\
          !or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q28, q26] > 0
               /\ contents_Function1DPartialR7_Flags[q28]
               /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q28, q26] = 3
                   | q26 : int(1..maxMaterial * 5)]))
             | q28 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q34] ->
         (colour_Function1DPartial_Values[q34] = 3 /\ colour_Function1DPartial_Flags[q34]
          ->
          !or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q34, q30] > 0
               /\ contents_Function1DPartialR7_Flags[q34]
               /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q34, q30] = 4
                   | q30 : int(1..maxMaterial * 5)])
          /\
          !or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q34, q32] > 0
               /\ contents_Function1DPartialR7_Flags[q34]
               /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q34, q32] = 2
                   | q32 : int(1..maxMaterial * 5)]))
             | q34 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q40] ->
         (colour_Function1DPartial_Values[q40] = 2 /\ colour_Function1DPartial_Flags[q40]
          ->
          !or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q40, q36] > 0
               /\ contents_Function1DPartialR7_Flags[q40]
               /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q40, q36] = 3
                   | q36 : int(1..maxMaterial * 5)])
          /\
          !or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q40, q38] > 0
               /\ contents_Function1DPartialR7_Flags[q40]
               /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q40, q38] = 1
                   | q38 : int(1..maxMaterial * 5)]))
             | q40 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q44] ->
         (colour_Function1DPartial_Values[q44] = 1 /\ colour_Function1DPartial_Flags[q44]
          ->
          sum([toInt(contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q44, q42]
                     > 0
                     /\ contents_Function1DPartialR7_Flags[q44])
               *
               toInt(contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q44, q42] =
                     4)
                   | q42 : int(1..maxMaterial * 5)])
          <= 1)
             | q44 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q48] ->
         (colour_Function1DPartial_Values[q48] = 2 /\ colour_Function1DPartial_Flags[q48]
          ->
          sum([toInt(contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q48, q46]
                     > 0
                     /\ contents_Function1DPartialR7_Flags[q48])
               *
               toInt(contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q48, q46] =
                     4)
                   | q46 : int(1..maxMaterial * 5)])
          <= 2)
             | q48 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q54] ->
         (or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q54, q52] > 0
              /\ contents_Function1DPartialR7_Flags[q54]
              /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q54, q52] = 4
                  | q52 : int(1..maxMaterial * 5)])
          ->
          or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q54, q50] > 0 /\
              contents_Function1DPartialR7_Flags[q54]
              /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q54, q50] = 2
                  | q50 : int(1..maxMaterial * 5)]))
             | q54 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q60] ->
         (or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q60, q58] > 0
              /\ contents_Function1DPartialR7_Flags[q60]
              /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q60, q58] = 1
                  | q58 : int(1..maxMaterial * 5)])
          ->
          !or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q60, q56] > 0
               /\ contents_Function1DPartialR7_Flags[q60]
               /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q60, q56] = 5
                   | q56 : int(1..maxMaterial * 5)]))
             | q60 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q66] ->
         (or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q66, q64] > 0
              /\ contents_Function1DPartialR7_Flags[q66]
              /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q66, q64] = 5
                  | q64 : int(1..maxMaterial * 5)])
          ->
          !or([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q66, q62] > 0
               /\ contents_Function1DPartialR7_Flags[q66]
               /\ contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q66, q62] = 2
                   | q62 : int(1..maxMaterial * 5)]))
             | q66 : int(1..let1)]),
    and([colour_Function1DPartial_Flags[q1] = false ->
         colour_Function1DPartial_Values[q1] = 1
             | q1 : int(1..let1)]),
    and([contents_Function1DPartialR7_Flags[q4] = false ->
         and([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q4, q17] = 0
                  | q17 : int(1..maxMaterial * 5)])
         /\
         and([contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q4, q18] = 1
                  | q18 : int(1..maxMaterial * 5)])
             | q4 : int(1..let1)]),
    and([contents_Function1DPartialR7_Flags[q6] ->
         and([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q6, q7 + 1] > 0
              ->
              contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q6, q7] <
              contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q6, q7 + 1]
                  | q7 : int(1..maxMaterial * 5 - 1)])
             | q6 : int(1..let1)]),
    and([contents_Function1DPartialR7_Flags[q6] ->
         and([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q6, q8] = 0 ->
              contents_Function1DPartialR7_Values_ExplicitWithFlags_Values[q6, q8] = 1
                  | q8 : int(1..maxMaterial * 5)])
             | q6 : int(1..let1)]),
    and([contents_Function1DPartialR7_Flags[q6] ->
         and([contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q6, q9 + 1] > 0
              -> contents_Function1DPartialR7_Values_ExplicitWithFlags_Flags[q6, q9] > 0
                  | q9 : int(1..maxMaterial * 5 - 1)])
             | q6 : int(1..let1)])

